(function ($) { function toIntegersAtLease(n) { return n < 10 ? "0" + n : n } Date.prototype.toJSON = function (date) { return date.getUTCFullYear() + "-" + toIntegersAtLease(date.getUTCMonth() + 1) + "-" + toIntegersAtLease(date.getUTCDate()) }; var escapeable = /["\\\x00-\x1f\x7f-\x9f]/g; var meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }; $.quoteString = function (string) { if (escapeable.test(string)) { return '"' + string.replace(escapeable, function (a) { var c = meta[a]; if (typeof c === "string") { return c } c = a.charCodeAt(); return "\\u00" + Math.floor(c / 16).toString(16) + (c % 16).toString(16) }) + '"' } return '"' + string + '"' }; $.toJSON = function (o) { var type = typeof (o); if (type == "undefined") { return "undefined" } else { if (type == "number" || type == "boolean") { return o + "" } else { if (o === null) { return "null" } } } if (type == "string") { return $.quoteString(o) } if (type == "object" && typeof o.toJSON == "function") { return o.toJSON() } if (type != "function" && typeof (o.length) == "number") { var ret = []; for (var i = 0; i < o.length; i++) { ret.push($.toJSON(o[i])) } return "[" + ret.join(", ") + "]" } if (type == "function") { throw new TypeError("Unable to convert object of type 'function' to json.") } ret = []; for (var k in o) { var name; var type = typeof (k); if (type == "number") { name = '"' + k + '"' } else { if (type == "string") { name = $.quoteString(k) } else { continue } } val = $.toJSON(o[k]); if (typeof (val) != "string") { continue } ret.push(name + ": " + val) } return "{" + ret.join(", ") + "}" }; $.evalJSON = function (src) { return eval("(" + src + ")") }; $.secureEvalJSON = function (src) { var filtered = src; filtered = filtered.replace(/\\["\\\/bfnrtu]/g, "@"); filtered = filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]"); filtered = filtered.replace(/(?:^|:|,)(?:\s*\[)+/g, ""); if (/^[\],:{}\s]*$/.test(filtered)) { return eval("(" + src + ")") } else { throw new SyntaxError("Error parsing JSON, source is not valid.") } } })(jQuery); HTB = { R: { urlRegExp: new RegExp(/(?:http:\/\/|https:\/\/|ftp:\/\/|ftps:\/\/|www.)[\w-]+[\w\d\:\<\>\#\@\%\/\;\$\(\)\~\_\?\+\-\=\\\.\&\|\!\^\*\''\''''\,]*/g), monthNames: ["يناير", "فبراير", "مارس", "أبريل", "مايو", "يونيو", "يوليو", "أغسطس", "سبتمبر", "أكتوبر", "نوفمبر", "ديسمبر"], halfMin: "منذ نصف دقيقة", lessMin: "منذ أقل من دقيقة", abut: "حوالي ", day: " يوم ", days: " أيام ", hours: " ساعات ", hour: " ساعة ", min: " دقيقة ", mins: " دقائق "} }; HTB.FN = { swapClass: function (a, b, c) { if ($(a).hasClass(b)) { $(a).removeClass(b.replace(".", "")); $(a).addClass(c.replace(".", "")) } else { $(a).removeClass(c.replace(".", "")); $(a).addClass(b.replace(".", "")) } }, chngExpToLnk: function (o) { var g = o.exp, n = o.txt, f = o.orgTmpl, k = o.exToEx, c = o.exToRmv; if (HTB.VL.isNlOrUn(k)) { k = [] } if (HTB.VL.isNlOrUn(c)) { c = [] } var l = HTB.FN.fltrByExp(n, g); if (!HTB.VL.isNlOrUn(l)) { for (var h = 0; h < l.length; h++) { var m = l[h]; for (var a = 0; a < c.length; a++) { if (m.indexOf(c[a]) > -1) { m = m.substring(0, m.indexOf(c[a])) } } if (m.length > 2 && !HTB.FN.cntanAny(m, k)) { if (!HTB.VL.isNlOrUn(f)) { var e = f.replace(/value/g, m), b = $(e).attr("href"); if (!HTB.VL.isNlOrUn(b) && b.length > 3 && b.substring(0, 3) == "www") { e = f.replace("value", "http://" + m).replace("value", m) } var d = 0; while (n.indexOf(m, d) > -1) { var j = n.substring(0, n.indexOf(m, d)) + e + n.substring(n.indexOf(m, d) + m.length, n.length); d = n.indexOf(m, d) + e.length; n = j } } } } } return n }, decdFrmXml: function (a) { while (a.indexOf("&lt;", 0) > -1) { a = a.replace("&lt;", "<") } while (a.indexOf("&gt;", 0) > -1) { a = a.replace("&gt;", ">") } while (a.indexOf("&quot;", 0) > -1) { a = a.replace("&quot;", "'") } return a }, trim: function (a) { return HTB.FN.ltrim(HTB.FN.rtrim(a)) }, ltrim: function (a) { return a.replace((/^\s+/g), "") }, rtrim: function (a) { return a.replace((/\s+$/g), "") }, getPropVal: function (e, c) { var d = c.split("."), a = e; for (var b = 0; b < d.length; b++) { if (HTB.VL.isNlOrUn(a[d[b]])) { return undefined } a = a[d[b]] } return a }, fltrByExp: function (a, c) { var b = new RegExp(c); return a.match(b) }, first: function (g, f, d) { if (HTB.VL.isNlOrUn(d)) { d = "" } for (var c = 0; c < g.length; c++) { var b = g[c]; if (d.toString().length > 0) { var e = d.split("."); for (var a = 0; a < e.length; a++) { if (typeof b[e[a]] == typeof undefined || b[e[a]] == null) { break } b = b[e[a]] } } if (b == f) { return g[c] } } return null }, all: function (h, g, e) { if (HTB.VL.isNlOrUn(e)) { e = "" } var c = new Array(); for (var d = 0; d < h.length; d++) { var b = h[d]; if (e.toString().length > 0) { var f = e.split("."); for (var a = 0; a < f.length; a++) { if (typeof b[f[a]] == typeof undefined || b[f[a]] == null) { break } b = b[f[a]] } } if (b == g) { c[c.length] = h[d] } } return c }, firstIndex: function (g, f, d) { if (HTB.VL.isNlOrUn(d)) { d = "" } for (var c = 0; c < g.length; c++) { var b = g[c]; if (d.toString().length > 0) { var e = d.split("."); for (var a = 0; a < e.length; a++) { if (typeof b[e[a]] == typeof undefined || b[e[a]] == null) { break } b = b[e[a]] } } if (typeof b == "string") { if (b.toLowerCase() == f.toLowerCase()) { return c } } else { if (b == f) { return c } } } return -1 }, remove: function (c, b) { for (var a = 0; a < c.length; a++) { if (c[a] == b) { c.splice(a, 1); a-- } } }, cntan: function (b, a) { return b.toString().indexOf(a) > -1 }, cntanAny: function (c, b) { for (var a = 0; a < b.length; a++) { if (HTB.FN.cntan(c, b[a])) { return true } } return false }, strRmvAl: function (b, c) { for (var a = 0; a < c.length; a++) { if (b.indexOf(c[a]) > -1) { b = b.replace(c[a], ""); a = 0 } } return b }, clnArr: function (b) { var a = new Array(); for (i in b) { if (b[i] instanceof Array) { a[i] = HTB.FN.clnArr(b[i]) } else { a[i] = b[i] } } return a }, gtln: function (b) { var a = 0; for (var c = 0; c < b.length; c++) { a++; if (b.charCodeAt(c) > 255) { a++ } } return a } }; HTB.VL = { isEmpty: function (a, b) { if (HTB.FN.trim($(a).val()) == HTB.FN.trim(b)) { return true } else { return false } }, isNlOrUn: function (a) { if (typeof a == typeof undefined || a == null || (typeof a == typeof NaN && isNaN(a))) { return true } return false }, isEmSt: function (a) { if (a.toString().length > 0) { return false } return true }, isNlOrUnOrEmSt: function (a) { if (!HTB.VL.isNlOrUn(a) && !HTB.VL.isEmSt(a)) { return false } return true }, isUrl: function (a) { if (a.match(HTB.R.urlRegExp)) { return true } return false } }; HTB.QueryString = { R: { qsObj: null }, loadCurrentQS: function () { HTB.QueryString.R.qsObj = new Object(); var b = location.href; if (b.indexOf("?") > -1) { var d = b.split("?")[1].split("&"); for (var c = 0; c < d.length; c++) { var a = d[c].split("="); HTB.QueryString.R.qsObj[a[0].toLowerCase()] = a[1] } } }, getQSValue: function (a) { if (!HTB.QueryString.R.qsObj) { HTB.QueryString.loadCurrentQS() } return HTB.QueryString.R.qsObj[a] } }; HTB.ajax = { R: { doCallbackHtml: function (d, b, c) { $.ajaxSetup({ contentType: "application/x-www-form-urlencoded" }); var a = "__CALLBACKID=" + escape(d) + "&__CALLBACKPARAM=" + escape(b) + "&__VIEWSTATE=&"; $.post(document.URL, a, function (g, e) { if (g.charAt(0) == "s") { e = "success"; g = g.substring(1) } else { if (g.charAt(0) == "e") { e = "error"; g = g.substring(1) } else { var h = g.indexOf("|"); if (h != -1) { var f = parseInt(g.substring(0, h)); if (!isNaN(f)) { g = g.substring(h + f + 1) } } } } if (c != null) { c(g, e) } }, "html") } } }; HTB.Cookie = { R: { getCookieUrl: "http://passport.linkonlineworld.com/SSOCore/Cookies/getcookie?callback=?", setCookieUrl: "http://passport.linkonlineworld.com/SSOCore/Cookies/setcookie?callback=?", setCookieKeyValueUrl: "http://passport.linkonlineworld.com/SSOCore/Cookies/setcookieKeyValue?callback=?", deleteCookieUrl: "http://passport.linkonlineworld.com/SSOCore/Cookies/deletecookie?callback=?" }, setCookie: function (b, c, d, a) { $.ajax({ url: HTB.Cookie.R.setCookieUrl, type: "GET", data: { name: b, value: c }, dataType: "jsonp", success: function (e) { if (d) { d(e) } }, error: function (e) { if (a) { a(e) } } }) }, getCookie: function (b, c, a) { $.ajax({ url: HTB.Cookie.R.getCookieUrl, type: "GET", data: { name: b }, dataType: "jsonp", success: function (d) { if (c) { c(d) } }, error: function (d) { if (a) { a(d) } } }) }, delCookie: function (b, c, a) { $.ajax({ url: HTB.Cookie.R.deleteCookieUrl, type: "GET", data: { name: b }, dataType: "jsonp", success: function (d) { if (c) { c(d) } }, error: function (d) { if (a) { a(d) } } }) }, getCookieKeyVal: function (c, a, d, b) { HTB.Cookie.getCookie(c, function (e) { if (d) { d(e.Items[a]) } }, function (e) { if (b) { b(e) } }) }, setCookieKeyVal: function (b, c, d, e, a) { $.ajax({ url: HTB.Cookie.R.setCookieKeyValueUrl, type: "GET", data: { name: b, key: c, value: d }, dataType: "jsonp", success: function (f) { if (e) { e(f) } }, error: function (f) { if (a) { a(f) } } }) } }; HTB.SSO = { R: { name: "SSO", isAuth: false, proxy: { deattach: { url: "http://passport.linkonlineworld.com/SSOCore/SSO/DeAttachIntegratedAccount?callback=?" }, login: { url: "", returnUrl: "", type: "GET", contentType: "text/html"}} }, chkLogin: function () { if (!HTB.SSO.R.isAuth) { HTB.Cookie.getCookie("SSOCookie", function (b) { if (!HTB.VL.isNlOrUnOrEmSt(b.Items) && !HTB.VL.isNlOrUnOrEmSt(b.Items.OriginalData) && !HTB.VL.isNlOrUnOrEmSt(b.Items.Signature)) { var c = HTB.SSO.R.proxy.login.returnUrl; c = c.substr(0, c.lastIndexOf("http://www.yallakora.com/")); var a = c + "/login.ashx?OriginalData=" + b.Items.OriginalData + "&Signature=" + b.Items.Signature + "&ReturnUrl=" + HTB.SSO.R.proxy.login.returnUrl; $.get(a, function (d) { }, function (d) { }) } else { } }, null) } }, login: function () { HTB.Cookie.delCookie("eny"); HTB.SSO.twitterLogin = {}; var a = this; var b = "location=0,status=0,width=500,height=600,titlebar=0,toolbar=0"; HTB.SSO.twitterLogin.loginWindow = window.open(HTB.SSO.R.proxy.login.url, "_blank", b); HTB.SSO.twitterLogin.twitterInterval = window.setInterval(function () { if (HTB.SSO.twitterLogin.loginWindow != null && HTB.SSO.twitterLogin.loginWindow.closed) { window.clearInterval(HTB.SSO.twitterLogin.twitterInterval); HTB.Cookie.getCookie("SSOCookie", function (d) { if (!HTB.VL.isNlOrUnOrEmSt(d.Items) && !HTB.VL.isNlOrUnOrEmSt(d.Items.OriginalData) && !HTB.VL.isNlOrUnOrEmSt(d.Items.Signature)) { var e = HTB.SSO.R.proxy.login.returnUrl; e = e.substr(0, e.lastIndexOf("http://www.yallakora.com/")); var c = e + "/login.ashx?OriginalData=" + d.Items.OriginalData + "&Signature=" + d.Items.Signature + "&ReturnUrl=" + HTB.SSO.R.proxy.login.returnUrl; window.location.href = c } else { } }) } }, 1000) }, attach: function () { HTB.Cookie.delCookie("eny"); HTB.SSO.twitterLogin = {}; var a = this; var b = "location=0,status=0,width=800,height=400,titlebar=0,toolbar=0"; HTB.SSO.twitterLogin.loginWindow = window.open(HTB.SSO.R.proxy.login.url, "_blank", b); HTB.SSO.twitterLogin.twitterInterval = window.setInterval(function () { if (HTB.SSO.twitterLogin.loginWindow != null && HTB.SSO.twitterLogin.loginWindow.closed) { window.clearInterval(HTB.SSO.twitterLogin.twitterInterval); HTB.Cookie.getCookie("eny", function (c) { if (!HTB.VL.isNlOrUnOrEmSt(c.Items) && !HTB.VL.isNlOrUnOrEmSt(c.Items.twitterUserName)) { $("#tuserName").text("Welcome " + c.Items.twitterUserName); HTB.SSO.R.isAuth = true } }) } }, 1000) }, deAttach: function (b, c, a) { $.ajax({ url: HTB.SSO.R.proxy.deattach.url, type: "GET", data: { delAccountIntegratedAccountObj: b }, dataType: "jsonp", success: function (d) { if (c) { c(d) } }, error: function (d) { if (a) { a(d) } } }) } }; $(document).ready(function () { }); HTB.MyFacebook = { R: { name: "MyFacebook", isAuth: false, proxy: { login: { url: "http://passport.linkonlineworld.com/SSOCore/Facebook/login?", type: "GET", contentType: "text/html"}} }, chkLogin: function () { if (!HTB.MyFacebook.R.isAuth) { HTB.MyFacebook.login(); return false } else { HTB.Cookie.getCookie("enyFB", function (a) { if (!HTB.VL.isNlOrUnOrEmSt(a.Items) && !HTB.VL.isNlOrUnOrEmSt(a.Items.facebookUserName)) { $("#fuserName").text("Welcome " + a.Items.facebookUserName); HTB.MyFacebook.R.isAuth = true } }) } }, login: function () { HTB.Cookie.delCookie("enyFB"); HTB.MyFacebook.FacebookLogin = {}; var a = this; var b = "location=0,status=0,width=800,height=400,titlebar=0,toolbar=0"; HTB.MyFacebook.FacebookLogin.loginWindow = window.open(HTB.MyFacebook.R.proxy.login.url, "_blank", b); HTB.MyFacebook.FacebookLogin.FacebookInterval = window.setInterval(function () { if (HTB.MyFacebook.FacebookLogin.loginWindow != null && HTB.MyFacebook.FacebookLogin.loginWindow.closed) { window.clearInterval(HTB.MyFacebook.FacebookLogin.FacebookInterval); HTB.Cookie.getCookie("SSOCookie", function (d) { if (!HTB.VL.isNlOrUnOrEmSt(d.Items) && !HTB.VL.isNlOrUnOrEmSt(d.Items.OriginalData) && !HTB.VL.isNlOrUnOrEmSt(d.Items.Signature)) { var e = unescape(HTB.QueryString.getQSValue("returnurl")); e = e.substr(0, e.lastIndexOf("http://www.yallakora.com/")); var c = e + "/login.ashx?OriginalData=" + d.Items.OriginalData + "&Signature=" + d.Items.Signature + "&ReturnUrl=" + HTB.QueryString.getQSValue("returnurl"); window.location.href = c } else { alert("operation didnt success") } }) } }, 1000) }, attach: function (a) { HTB.Cookie.delCookie("enyFB"); HTB.MyFacebook.FacebookLogin = {}; var b = this; var c = "location=0,status=0,width=800,height=400,titlebar=0,toolbar=0"; HTB.MyFacebook.FacebookLogin.loginWindow = window.open(HTB.MyFacebook.R.proxy.login.url, "_blank", c); HTB.MyFacebook.FacebookLogin.FacebookInterval = window.setInterval(function () { if (HTB.MyFacebook.FacebookLogin.loginWindow != null && HTB.MyFacebook.FacebookLogin.loginWindow.closed) { a(""); window.clearInterval(HTB.MyFacebook.FacebookLogin.FacebookInterval); HTB.Cookie.getCookie("enyFB", function (d) { if (!HTB.VL.isNlOrUnOrEmSt(d.Items) && !HTB.VL.isNlOrUnOrEmSt(d.Items.facebookUserName)) { HTB.MyFacebook.R.isAuth = true } }) } }, 1000) } }; HTB.MyTwitter = { R: { name: "MyTwitter", isAuth: false, proxy: { login: { url: "http://passport.linkonlineworld.com/SSOCore/Twitter/login?", type: "GET", contentType: "text/html"}} }, chkLogin: function () { if (!HTB.MyTwitter.R.isAuth) { HTB.MyTwitter.login(); return false } else { HTB.Cookie.getCookie("eny", function (a) { if (!HTB.VL.isNlOrUnOrEmSt(a.Items) && !HTB.VL.isNlOrUnOrEmSt(a.Items.twitterUserName)) { $("#tuserName").text("attached successfully to twitterWelcome " + a.Items.twitterUserName); HTB.MyTwitter.R.isAuth = true } }) } }, login: function () { HTB.Cookie.delCookie("eny"); HTB.MyTwitter.twitterLogin = {}; var a = this; var b = "location=0,status=0,width=800,height=400,titlebar=0,toolbar=0"; HTB.MyTwitter.twitterLogin.loginWindow = window.open(HTB.MyTwitter.R.proxy.login.url, "_blank", b); HTB.MyTwitter.twitterLogin.twitterInterval = window.setInterval(function () { if (HTB.MyTwitter.twitterLogin.loginWindow != null && HTB.MyTwitter.twitterLogin.loginWindow.closed) { window.clearInterval(HTB.MyTwitter.twitterLogin.twitterInterval); HTB.Cookie.getCookie("SSOCookie", function (d) { if (!HTB.VL.isNlOrUnOrEmSt(d.Items) && !HTB.VL.isNlOrUnOrEmSt(d.Items.OriginalData) && !HTB.VL.isNlOrUnOrEmSt(d.Items.Signature)) { var e = unescape(HTB.QueryString.getQSValue("returnurl")); e = e.substr(0, e.lastIndexOf("http://www.yallakora.com/")); var c = e + "/login.ashx?OriginalData=" + d.Items.OriginalData + "&Signature=" + d.Items.Signature + "&ReturnUrl=" + HTB.QueryString.getQSValue("returnurl"); window.location.href = c } else { alert("operation didnt success") } }) } }, 1000) }, attach: function (a) { HTB.Cookie.delCookie("eny"); HTB.MyTwitter.twitterLogin = {}; var b = this; var c = "location=0,status=0,width=800,height=400,titlebar=0,toolbar=0"; HTB.MyTwitter.twitterLogin.loginWindow = window.open(HTB.MyTwitter.R.proxy.login.url, "_blank", c); HTB.MyTwitter.twitterLogin.twitterInterval = window.setInterval(function () { if (HTB.MyTwitter.twitterLogin.loginWindow != null && HTB.MyTwitter.twitterLogin.loginWindow.closed) { a(""); window.clearInterval(HTB.MyTwitter.twitterLogin.twitterInterval); HTB.Cookie.getCookie("eny", function (d) { if (!HTB.VL.isNlOrUnOrEmSt(d.Items) && !HTB.VL.isNlOrUnOrEmSt(d.Items.twitterUserName)) { HTB.MyTwitter.R.isAuth = true } }) } }, 1000) } };